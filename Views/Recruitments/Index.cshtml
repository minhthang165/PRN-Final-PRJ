@{
    ViewData["Title"] = "Recruitment Board";
}

<div id="recruitment-board" class="row"></div>
<div id="pagination" class="mt-4"></div>

@section Scripts {
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            loadPage(1, 6); // Your API starts at page=1
        });

        function loadPage(page, pageSize) {
            fetch(`/api/recruitment/paging?page=${page}&pageSize=${pageSize}`)
                .then(response => response.json())
                .then(data => {
                    renderRecruitments(data.content);
                    renderPagination(data.totalPages, data.number);
                })
                .catch(err => console.error(err));
        }

        function renderRecruitments(recruitments) {
            const board = document.getElementById('recruitment-board');
            board.innerHTML = '';

            for (let r of recruitments) {
                board.innerHTML += `
                    <div class="col-md-4 mb-4">
                        <div class="card recruitment-card shadow-sm p-3">
                            <div class="d-flex justify-content-between mb-2">
                                <span><strong>Position:</strong> ${r.position}</span>
                                <span><strong>End:</strong> ${new Date(r.end_time).toLocaleDateString()}</span>
                            </div>
                            <h5 class="card-title">${r.name}</h5>
                            <p class="text-muted">
                                <i class="fas fa-code"></i> ${r.language || 'N/A'} |
                                <i class="fas fa-briefcase"></i> ${r.experience_requirement}
                            </p>
                            <p><i class="fas fa-users"></i> ${r.total_slot} Total Slot</p>

                            <div class="position-relative recruitment-image">
                                <img src="/assets/img/event/default_Recruitment.jpg" class="card-img-top img-fluid" />
                            </div>

                            <div class="card-body text-end mt-2">
                                <a href="/Recruitment/Detail/${r.id}" class="btn btn-gradient">View Detail</a>
                            </div>
                        </div>
                    </div>
                `;
            }
        }

        function renderPagination(totalPages, currentPage) {
            const pagination = document.getElementById('pagination');
            pagination.innerHTML = '';

            for (let i = 1; i <= totalPages; i++) {
                pagination.innerHTML += `
                    <button onclick="loadPage(${i}, 6)"
                        class="btn ${i === currentPage ? 'btn-primary' : 'btn-outline-primary'} mx-1">
                        ${i}
                    </button>`;
            }
        }
    </script>
}
