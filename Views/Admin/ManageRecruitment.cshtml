@{
    ViewData["Title"] = "Manage Recruitment";
}

<link rel="stylesheet" href="/css/manageRequirement.css" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet" />

<div class="app__slide-wrapper">
    <div class="breadcrumb__area">
        <div class="breadcrumb__wrapper mb-35" style="padding: 0px;">
            <div class="breadcrumb__main">
                <div class="breadcrumb__inner">
                    <div class="breadcrumb__icon">
                        <i class="flaticon-home"></i>
                    </div>
                    <div class="breadcrumb__menu">
                        <nav>
                            <ul>
                                <li><span><a asp-controller="Admin" asp-action="Index">Dashboard</a></span></li>
                                <li class="active"><span>Manage Requirement</span></li>
                            </ul>
                        </nav>
                    </div>
                </div>
                <div class="search_add d-flex justify-content-between align-items-center">
                    <div class="new_class">
                        <div class="breadcrum__button">
                            <button class="element__btn yellow-bg" data-bs-toggle="modal" data-bs-target="#addUserModal">
                                Add Recruitment +
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="flex-grow-1 p-4">
        <h3 style="font-weight: bold">Recruitment List</h3>
        <!-- Table -->
        <div class="card mt-4">
            <div class="card-body">
                <div class="d-flex align-items-center mb-3">
                    <input type="text" id="searchInput" class="form-control"
                           style="width: 250px; margin-right: 10px;"
                           placeholder="Search requirements..." onkeyup="filterTable()">
                    <button class="btn btn-outline-primary btn-sm" onclick="sortTable(0)">Sort by Name</button>
                    <button class="btn btn-outline-primary btn-sm mx-2" onclick="sortTable(1)">Sort by Position</button>
                    <button class="btn btn-outline-primary btn-sm" onclick="sortTable(4)">Sort By GPA</button>

                    <!-- Selected rows action buttons -->
                    <div id="selectedActions" class="ms-auto" style="display: none;">
                        <span class="me-2">Selected: <span id="selectedCount">0</span></span>
                        <button class="btn btn-danger btn-sm">Delete Selected</button>
                    </div>
                </div>
                <table id="recruitmentTable" class="table table-striped">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Position</th>
                            <th>Experience Requirement</th>
                            <th>Language</th>
                            <th>Min GPA</th>
                            <th>End Time</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="table-content"></tbody>
                </table>
                <div class="table-footer">
                    <div class="records-selector">
                        <span>Show</span>
                        <select class="records-per-page" style="width: 64px" onchange="changePageSize(this)">
                            <option value="5" selected>5</option>
                            <option value="10">10</option>
                            <option value="20">20</option>
                            <option value="50">50</option>
                        </select>
                        <span>record</span>
                    </div>
                    <div class="pagination-container">
                        <ul id="pagination-list" class="pagination-list">
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Candidate Modal -->
    <div id="candidateModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <div class="header">
                <h3 id="modalTitle">Candidate List</h3>
                <div class="search-bar">
                    <div class="d-flex gap-2 align-items-center">
                        <input type="text" id="searchCandidateInput" class="search-input"
                               placeholder="Search candidates...">
                        <button class="btn btn-primary" id="searchCandidateButton">Search</button>
                    </div>
                </div>
            </div>

            <div class="card mt-4">
                <div class="table-container">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Full Name</th>
                                <th>GPA</th>
                                <th>Education</th>
                                <th>Skills</th>
                                <th>CV File</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="candidateTableBody">
                            <!-- Candidate data will be loaded here dynamically -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Recruitment Modal -->
    <div class="modal fade" id="editRecruitmentModal" tabindex="-1" aria-labelledby="editRecruitmentModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editRecruitmentModalLabel">Edit Recruitment</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editRecruitmentForm">
                        <input type="hidden" id="editRecruitmentId">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="editName" class="form-label">Name</label>
                                <input type="text" class="form-control" id="editName" required>
                            </div>
                            <div class="col-md-6">
                                <label for="editPosition" class="form-label">Position</label>
                                <input type="text" class="form-control" id="editPosition" required>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="editExperienceRequirement" class="form-label">Experience Requirement</label>
                                <input type="text" class="form-control" id="editExperienceRequirement" placeholder="e.g., 1 year">
                            </div>
                            <div class="col-md-6">
                                <label for="editLanguage" class="form-label">Language</label>
                                <input type="text" class="form-control" id="editLanguage" placeholder="e.g., English, Japanese">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="editMinGPA" class="form-label">Minimum GPA</label>
                                <input type="number" step="0.1" min="0" max="4.0" class="form-control" id="editMinGPA" required>
                            </div>
                            <div class="col-md-6">
                                <label for="editTotalSlot" class="form-label">Total Slots</label>
                                <input type="number" min="1" class="form-control" id="editTotalSlot" required>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="editEndTime" class="form-label">End Time</label>
                            <input type="date" class="form-control" id="editEndTime" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="saveRecruitmentChanges">Save Changes</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div class="modal fade" id="deleteRecruitmentModal" tabindex="-1" aria-labelledby="deleteRecruitmentModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="deleteRecruitmentModalLabel">Confirm Delete</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>Are you sure you want to delete this recruitment? This action cannot be undone.</p>
                    <p><strong>Recruitment: </strong><span id="deleteRecruitmentName"></span></p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-danger" id="confirmDeleteRecruitment">Delete</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Requirement Modal -->
    <div id="addRequirementModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeAddRequirementModal()">×</span>
            <div class="header">
                <h3>Create Requirement</h3>
            </div>

            <form id="requirementForm">
                <div class="form-group mb-3">
                    <label for="requirementName">Requirement Name</label>
                    <input type="text" class="form-control" id="requirementName" name="name" placeholder="Enter requirement name" required>
                </div>

                <div class="form-group mb-3">
                    <label for="position">Position</label>
                    <input type="text" class="form-control" id="position" name="position" placeholder="Enter position" required>
                </div>

                <div class="form-group mb-3">
                    <label for="description">Description</label>
                    <textarea class="form-control" id="description" name="description" rows="3" placeholder="Enter requirement description"></textarea>
                </div>

                <div class="form-group mb-3">
                    <label for="experienceRequirement">Experience Requirement <span class="text-danger">*</span></label>
                    <textarea class="form-control" id="experienceRequirement" name="experienceRequirement" rows="2" placeholder="Describe experience requirements" required></textarea>
                    <small class="text-muted">This field is required and cannot be empty.</small>
                </div>

                <div class="form-group mb-3">
                    <label for="language">Language <span class="text-danger">*</span></label>
                    <input type="text" class="form-control" id="language" name="language" placeholder="Required languages (e.g., English, Japanese)" required>
                </div>

                <div class="form-group mb-3">
                    <label for="minGPA">Minimum GPA <span class="text-danger">*</span></label>
                    <input type="number" class="form-control" id="minGPA" name="minGPA" placeholder="Minimum GPA required" step="0.1" min="0" max="4.0" required>
                </div>

                <div class="form-group mb-3">
                    <label for="totalSlot">Total Slot <span class="text-danger">*</span></label>
                    <input type="number" class="form-control" id="totalSlot" name="totalSlot" placeholder="Number of available positions" min="1" required>
                </div>

                <div class="form-group mb-3">
                    <label for="endTime">End Date <span class="text-danger">*</span></label>
                    <input type="date" class="form-control" id="endTime" name="endTime" required>
                </div>

                <div class="form-group mb-3">
                    <label for="classId">Classroom <span class="text-danger">*</span></label>
                    <select class="form-control" id="classId" name="classId" required>
                        <option value="">Select a Classroom</option>
                        <!-- Options will be populated by JavaScript -->
                    </select>
                </div>

                <div class="text-end mt-4">
                    <button type="button" class="btn btn-secondary me-2" onclick="closeAddRequirementModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary" id="saveButton" style="background-color: #ff6600; border-color: #ff6600;">Save</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toastNotification" class="toast-notification">
        <div class="toast-content">
            <i class="fas fa-check-circle toast-icon"></i>
            <div class="toast-message" id="toastMessage">Notification message</div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="/js/manageRequirement.js"></script>
}